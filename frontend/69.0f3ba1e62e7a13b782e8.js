(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{"8+f4":function(t,e,i){"use strict";i.r(e),i.d(e,"PosSettingsModule",(function(){return _}));var c=i("ofXK"),s=i("tyNb"),n=i("fXoL"),r=i("t0ZU"),o=i("wd/R"),a=i("Kj3r"),l=i("eIep"),d=i("cp0P"),h=i("1kSV"),g=i("tk/3"),u=i("5eHb"),p=i("3Pt+");const m=["settingsModal"];function f(t,e){if(1&t){const t=n.ic();n.hc(0,"tr"),n.hc(1,"td"),n.cd(2),n.gc(),n.hc(3,"td"),n.cd(4),n.gc(),n.hc(5,"td"),n.cd(6),n.gc(),n.hc(7,"td"),n.cd(8),n.gc(),n.hc(9,"td"),n.hc(10,"span",25),n.sc("click",(function(){n.Pc(t);const i=e.$implicit;return n.wc().addPrinterSettings("edit",i)})),n.cd(11,"Edit"),n.gc(),n.gc(),n.gc()}if(2&t){const t=e.$implicit,i=e.index,c=n.wc();n.Nb(2),n.dd(i+1),n.Nb(2),n.ed(" ",(null==t?null:t.outlet)||"N/A"," "),n.Nb(2),n.ed(" ",(null==t?null:t.printer_name)||"N/A"," "),n.Nb(2),n.ed(" ",(null==t?null:t.mapped_on)||c.date," ")}}function b(t,e){1&t&&(n.hc(0,"div",26),n.hc(1,"h5"),n.hc(2,"b"),n.cd(3,"No Data Found"),n.gc(),n.gc(),n.gc())}function P(t,e){if(1&t){const t=n.ic();n.hc(0,"div",27),n.hc(1,"div",28),n.hc(2,"select",29),n.sc("ngModelChange",(function(e){return n.Pc(t),n.wc().filters.itemsPerPage=e}))("change",(function(){return n.Pc(t),n.wc().checkPagination()})),n.hc(3,"option",30),n.cd(4,"20"),n.gc(),n.hc(5,"option",30),n.cd(6,"50"),n.gc(),n.hc(7,"option",30),n.cd(8,"100"),n.gc(),n.hc(9,"option",30),n.cd(10,"150"),n.gc(),n.hc(11,"option",30),n.cd(12,"500"),n.gc(),n.gc(),n.gc(),n.gc()}if(2&t){const t=n.wc();n.Nb(2),n.Dc("ngModel",t.filters.itemsPerPage),n.Nb(1),n.Dc("value",20),n.Nb(2),n.Dc("value",50),n.Nb(2),n.Dc("value",100),n.Nb(2),n.Dc("value",150),n.Nb(2),n.Dc("value",500)}}function v(t,e){if(1&t&&(n.hc(0,"option",30),n.cd(1),n.gc()),2&t){const t=e.$implicit;n.Dc("value",t.name),n.Nb(1),n.dd(t.outlet_name)}}function D(t,e){1&t&&(n.hc(0,"small",51),n.cd(1,"Required"),n.gc())}function S(t,e){if(1&t&&(n.hc(0,"option",30),n.cd(1),n.gc()),2&t){const t=e.$implicit;n.Dc("value",t.name),n.Nb(1),n.ed("",t.printer_name," ")}}function y(t,e){1&t&&(n.hc(0,"small",51),n.cd(1,"Required"),n.gc())}function N(t,e){if(1&t){const t=n.ic();n.hc(0,"div",31),n.hc(1,"h6"),n.hc(2,"b",32),n.cd(3),n.gc(),n.gc(),n.hc(4,"button",33),n.sc("click",(function(){return n.Pc(t),n.wc().modalClose()})),n.hc(5,"span",34),n.cd(6,"\xd7"),n.gc(),n.gc(),n.gc(),n.hc(7,"div",35),n.hc(8,"form",36,37),n.sc("ngSubmit",(function(){n.Pc(t);const e=n.Nc(9);return n.wc().onSubmit(e)})),n.hc(10,"div",12),n.hc(11,"div",13),n.hc(12,"div",38),n.hc(13,"label",39),n.cd(14,"Outlet"),n.gc(),n.hc(15,"select",40,41),n.sc("ngModelChange",(function(e){return n.Pc(t),n.wc().formData.outlet=e})),n.hc(17,"option",42),n.cd(18,"Please Select Outlet"),n.gc(),n.ad(19,v,2,2,"option",43),n.gc(),n.ad(20,D,2,0,"small",44),n.gc(),n.gc(),n.hc(21,"div",13),n.hc(22,"div",38),n.hc(23,"label",45),n.cd(24,"Printer"),n.gc(),n.hc(25,"select",46,47),n.sc("ngModelChange",(function(e){return n.Pc(t),n.wc().formData.printer=e})),n.hc(27,"option",42),n.cd(28,"Please Select Printer"),n.gc(),n.ad(29,S,2,2,"option",43),n.gc(),n.ad(30,y,2,0,"small",44),n.gc(),n.gc(),n.hc(31,"div",48),n.hc(32,"button",49),n.sc("click",(function(){return n.Pc(t),n.wc().modalClose()})),n.cd(33,"Cancel"),n.gc(),n.hc(34,"button",50),n.cd(35,"Save"),n.gc(),n.gc(),n.gc(),n.gc(),n.gc()}if(2&t){const t=n.Nc(9),e=n.Nc(16),i=n.Nc(26),c=n.wc();n.Nb(3),n.ed("",c.viewType," Printer Settings"),n.Nb(12),n.Dc("ngModel",c.formData.outlet),n.Nb(2),n.Dc("ngValue",void 0),n.Nb(2),n.Dc("ngForOf",c.outletList),n.Nb(1),n.Dc("ngIf",t.touched&&(null==e||null==e.errors?null:e.errors.required)),n.Nb(5),n.Dc("ngModel",c.formData.printer),n.Nb(2),n.Dc("ngValue",void 0),n.Nb(2),n.Dc("ngForOf",c.printersList),n.Nb(1),n.Dc("ngIf",t.touched&&(null==i||null==i.errors?null:i.errors.required))}}class O{constructor(){this.itemsPerPage=20,this.currentPage=1,this.totalCount=0,this.search="",this.printer="",this.start=0}}const M=[{path:"",component:(()=>{class t{constructor(t,e,i,c,s){this.modal=t,this.http=e,this.toaster=i,this.activatedRoute=c,this.router=s,this.filters=new O,this.onSearch=new n.q,this.formData={},this.posPrinters=[],this.printersList=[],this.outletList=[],this.date=o(new Date).format("YYYY-MM-DD HH:mm:ss")}ngOnInit(){this.formData.status="Enable",this.onSearch.pipe(Object(a.a)(500)).subscribe(t=>this.updateRouterParams()),this.getPOSPrinterSettings()}getPOSPrinterSettings(){this.activatedRoute.queryParams.pipe(Object(l.a)(t=>this.http.post(r.a.posPrinterSettings,{data:{start:this.filters.start,end:this.filters.itemsPerPage,value:this.filters.search,type:this.filters.search?"":"All"}}))).subscribe(t=>{var e,i;try{(null==t?void 0:t.message)&&(this.posPrinters=0!=this.filters.start?this.posPrinters.concat(null===(e=t.message)||void 0===e?void 0:e.data):null===(i=t.message)||void 0===i?void 0:i.data,this.filters.totalCount=t.message.count)}catch(c){console.log(c)}})}updateRouterParams(){this.router.navigate(["home/pos-bills-settings"],{queryParams:this.filters})}addPrinterSettings(t,e){this.getOutlets(),this.getPrinter(),"edit"==t?(this.formData=Object.assign({},e),this.editItem=Object.assign({},e),this.viewType="edit"):(this.formData={},this.viewType="add",this.editItem=null),setTimeout(()=>{this.modal.open(this.settingsModal,{size:"md",centered:!0})},1e3)}onSubmit(t){if(t.form.markAllAsTouched(),t.valid){this.formData.mapped_on=this.date,this.formData.doctype=r.b.posPrintSettings;const t=new FormData;t.append("doc",JSON.stringify(this.formData)),t.append("action","Save"),this.http[this.editItem?"put":"post"](this.editItem?`${r.a.resource}/${r.b.posPrintSettings}/${this.editItem.name}`:""+r.a.fileSave,this.editItem?this.formData:t).subscribe(t=>{t?(console.log(t),this.getPOSPrinterSettings(),this.toaster.success("successfully added"),this.modal.dismissAll()):(console.log(t),this.toaster.error(t._server_messages))},t=>{this.toaster.error("This Outlet is already mapped to other printer.")})}}getPrintSettings(){this.activatedRoute.queryParams.pipe(Object(l.a)(t=>{this.filters.totalCount=parseInt(t.totalCount,0)||this.filters.totalCount,this.filters.search=t.search||this.filters.search;const e={filters:[]};this.filters.search&&e.filters.push(["outlet","like",`%${this.filters.search}%`]),e.limit_page_length=this.filters.itemsPerPage,e.order_by="`tabPOS Print Settings`.`modified` desc",e.fields=JSON.stringify(["outlet","printer","printer_name","mapped_on","name"]),e.filters=JSON.stringify(e.filters);const i=this.http.get(`${r.a.resource}/${r.b.posPrintSettings}`,{params:{fields:JSON.stringify(["count( `tabPOS Print Settings`.`name`) AS total_count"]),filters:e.filters}}),c=this.http.get(`${r.a.resource}/${r.b.posPrintSettings}`,{params:e});return Object(d.a)([i,c])})).subscribe(t=>{1==this.filters.currentPage&&(this.posPrinters=[]);const[e,i]=t;this.filters.totalCount=e.data[0].total_count,i.data&&(this.posPrinters=1!==this.filters.currentPage?this.posPrinters.concat(i.data):i.data)})}checkPagination(){this.filters.currentPage=1,this.updateRouterParams()}getPrinter(){this.http.get(`${r.a.resource}/${r.b.posPrinters}`,{params:{limit_page_length:"None",fields:JSON.stringify(["last_used","printer_ip","printer_name","status","name"])}}).subscribe(t=>{if(console.log(t),this.printersList=t.data,this.printersList.length&&this.formData.printer){let t=this.printersList.find(t=>t.printer_ip==this.formData.printer);this.formData.printer=t.name,console.log(this.formData.printer)}})}getOutlets(){this.http.get(`${r.a.resource}/${r.b.outlets}`,{params:{limit_page_length:"None",fields:JSON.stringify(["outlet_name","name"])}}).subscribe(t=>{if(console.log(t),this.outletList=t.data,this.outletList.length&&this.formData.outlet){let t=this.outletList.find(t=>t.outlet_name==this.formData.outlet);this.formData.outlet=t.name,console.log(this.formData.outlet)}})}modalClose(){this.modal.dismissAll(),this.formData={}}}return t.\u0275fac=function(e){return new(e||t)(n.bc(h.k),n.bc(g.b),n.bc(u.d),n.bc(s.a),n.bc(s.e))},t.\u0275cmp=n.Vb({type:t,selectors:[["app-pos-settings"]],viewQuery:function(t,e){var i;1&t&&n.jd(m,!0),2&t&&n.Mc(i=n.tc())&&(e.settingsModal=i.first)},decls:42,vars:4,consts:[[1,"row","mb-3"],[1,"col-md-9","col-lg-9"],[1,"d-flex"],[1,"text-white"],["type","button",1,"btn","btn-primary","ml-3",3,"click"],[1,"ri-add-line"],[1,"col-md-3","text-right"],[1,"position-relative","mt-2","mt-lg-0","mt-md-0"],["type","search","placeholder","Search by Outlet",1,"form-control","pl-5",3,"ngModel","ngModelChange","keyup","search"],["search",""],[1,"search"],[1,"ri-search-line"],[1,"row"],[1,"col-md-12"],[1,"card","border-0","shadow"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-bordered"],[1,"pl-4"],[4,"ngFor","ngForOf"],["class","text-center py-5",4,"ngIf"],[1,"col-md-11"],[1,"col-md-1"],["class","text-right mb-2",4,"ngIf"],["settingsModal",""],[1,"text-primary","cursor-pointer",3,"click"],[1,"text-center","py-5"],[1,"text-right","mb-2"],[1,"px-2"],["name","itemsPerPage","id","itemsPerPage",1,"custom-select",3,"ngModel","ngModelChange","change"],[3,"value"],[1,"modal-header"],[1,"text-capitalize"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[3,"ngSubmit"],["form","ngForm"],[1,"form-group"],["for","outlet"],["id","outlet","name","outlet","required","",1,"custom-select",3,"ngModel","ngModelChange"],["outlet","ngModel"],["hidden","","selected","",3,"ngValue"],[3,"value",4,"ngFor","ngForOf"],["class","text-danger",4,"ngIf"],["for","printer"],["id","printer","name","printer","required","",1,"custom-select",3,"ngModel","ngModelChange"],["printer","ngModel"],[1,"text-right","col-md-12"],["type","button",1,"btn","btn-outline-primary",3,"click"],["type","submit",1,"btn","btn-primary","ml-3"],[1,"text-danger"]],template:function(t,e){if(1&t){const t=n.ic();n.hc(0,"section"),n.hc(1,"div",0),n.hc(2,"div",1),n.hc(3,"div",2),n.hc(4,"h4",3),n.hc(5,"b"),n.cd(6,"Printer Settings"),n.gc(),n.gc(),n.hc(7,"button",4),n.sc("click",(function(){return e.addPrinterSettings("add",null)})),n.cc(8,"i",5),n.gc(),n.gc(),n.gc(),n.hc(9,"div",6),n.hc(10,"div",7),n.hc(11,"input",8,9),n.sc("ngModelChange",(function(t){return e.filters.search=t}))("keyup",(function(){n.Pc(t);const i=n.Nc(12);return e.filters.search=i.value,e.onSearch.emit(e.filters)}))("search",(function(){return e.onSearch.emit(e.filters)})),n.gc(),n.hc(13,"span",10),n.cc(14,"i",11),n.gc(),n.gc(),n.gc(),n.gc(),n.hc(15,"div",12),n.hc(16,"div",13),n.hc(17,"div",14),n.hc(18,"div",15),n.hc(19,"div",16),n.hc(20,"table",17),n.hc(21,"thead"),n.hc(22,"tr"),n.hc(23,"th",18),n.cd(24,"S.No"),n.gc(),n.hc(25,"th"),n.cd(26,"Outlet"),n.gc(),n.hc(27,"th"),n.cd(28,"Printer"),n.gc(),n.hc(29,"th"),n.cd(30,"Mapped On"),n.gc(),n.hc(31,"th"),n.cd(32,"Actions"),n.gc(),n.gc(),n.gc(),n.hc(33,"tbody"),n.ad(34,f,12,4,"tr",19),n.gc(),n.gc(),n.ad(35,b,4,0,"div",20),n.gc(),n.hc(36,"div",12),n.cc(37,"div",21),n.hc(38,"div",22),n.ad(39,P,13,6,"div",23),n.gc(),n.gc(),n.gc(),n.gc(),n.gc(),n.gc(),n.gc(),n.ad(40,N,36,9,"ng-template",null,24,n.bd)}2&t&&(n.Nb(11),n.Dc("ngModel",e.filters.search),n.Nb(23),n.Dc("ngForOf",e.posPrinters),n.Nb(1),n.Dc("ngIf",!(null!=e.posPrinters&&e.posPrinters.length)),n.Nb(4),n.Dc("ngIf",null==e.posPrinters?null:e.posPrinters.length))},directives:[p.b,p.i,p.l,c.o,c.p,p.r,p.m,p.t,p.u,p.j,p.k,p.q],styles:[".table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:8px;font-size:14px;border:1px solid rgba(221,218,218,.3)}.form-group[_ngcontent-%COMP%]{margin-bottom:10px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px}"]}),t})()}];let w=(()=>{class t{}return t.\u0275mod=n.Zb({type:t}),t.\u0275inj=n.Yb({factory:function(e){return new(e||t)},imports:[[s.i.forChild(M)],s.i]}),t})(),_=(()=>{class t{}return t.\u0275mod=n.Zb({type:t}),t.\u0275inj=n.Yb({factory:function(e){return new(e||t)},imports:[[c.c,w,p.d]]}),t})()}}]);