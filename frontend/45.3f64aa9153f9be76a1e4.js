(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{IwCN:function(e,n,t){"use strict";t.r(n),t.d(n,"LoginModule",(function(){return q}));var c=t("ofXK"),o=t("tyNb"),s=t("t0ZU"),r=t("fXoL"),i=t("wd/R"),a=t.n(i),l=t("tk/3"),d=t("5eHb"),g=t("yFR0"),u=t("1kSV"),h=t("b6Qw"),p=t("3Pt+"),m=t("HgEw");const f=["content"];function w(e,n){1&e&&(r.hc(0,"small",21),r.cd(1,"Required"),r.gc())}function b(e,n){1&e&&(r.hc(0,"small",21),r.cd(1,"Required"),r.gc())}function _(e,n){if(1&e&&(r.hc(0,"div",22),r.cc(1,"input",37,38),r.hc(3,"label",39),r.cd(4,"Password"),r.gc(),r.ad(5,b,2,0,"small",26),r.gc()),2&e){const e=r.Oc(2);r.wc();const n=r.Oc(47);r.Nb(5),r.Ec("ngIf",n.submitted&&(null==e||null==e.errors?null:e.errors.required))}}function v(e,n){if(1&e){const e=r.ic();r.hc(0,"button",40),r.sc("click",(function(){r.Qc(e);const n=r.wc(),t=r.Oc(47);return n.resetPAssword(t)})),r.cd(1,"Sign In"),r.gc()}}function M(e,n){if(1&e){const e=r.ic();r.hc(0,"button",40),r.sc("click",(function(){r.Qc(e);const n=r.wc(),t=r.Oc(47);return n.onSubmit(t)})),r.cd(1,"Sign In"),r.gc()}}function P(e,n){if(1&e&&(r.hc(0,"small",21),r.cd(1),r.gc()),2&e){const e=r.wc(2);r.Nb(1),r.dd(e.wrong_password)}}function C(e,n){if(1&e&&(r.hc(0,"small",57),r.cd(1),r.gc()),2&e){const e=r.wc(2);r.Nb(1),r.dd(e.wrong_password)}}function O(e,n){1&e&&(r.hc(0,"small",21),r.cd(1,"Required"),r.gc())}function y(e,n){1&e&&(r.hc(0,"small",21),r.cd(1,"Check password pattern"),r.gc())}function x(e,n){1&e&&(r.hc(0,"small",21),r.cd(1,"Try new password"),r.gc())}function k(e,n){1&e&&(r.hc(0,"small",21),r.cd(1,"password mismatch"),r.gc())}function I(e,n){if(1&e){const e=r.ic();r.hc(0,"div",41),r.hc(1,"h6",42),r.hc(2,"strong"),r.cd(3,"Reset Password "),r.gc(),r.gc(),r.gc(),r.hc(4,"div",43),r.hc(5,"form",null,19),r.hc(7,"div",22),r.hc(8,"input",44,45),r.sc("ngModelChange",(function(n){return r.Qc(e),r.wc().change_user_details.old_password=n}))("ngModelChange",(function(n){return r.Qc(e),r.wc().check_old_password(n)})),r.gc(),r.hc(10,"label",46),r.cd(11,"Old Password"),r.gc(),r.ad(12,P,2,1,"small",26),r.ad(13,C,2,1,"small",47),r.gc(),r.hc(14,"div",22),r.hc(15,"input",48,49),r.sc("ngModelChange",(function(n){return r.Qc(e),r.wc().change_user_details.new_password=n})),r.gc(),r.hc(17,"label",50),r.cd(18,"New Password"),r.gc(),r.hc(19,"small",51),r.cd(20,"should contain special characters and alphanumeric with min 6 and max 20 characters"),r.gc(),r.cc(21,"br"),r.ad(22,O,2,0,"small",26),r.ad(23,y,2,0,"small",26),r.ad(24,x,2,0,"small",26),r.gc(),r.hc(25,"div",22),r.hc(26,"input",52,53),r.sc("ngModelChange",(function(n){return r.Qc(e),r.wc().change_user_details.confirmPassword=n})),r.gc(),r.hc(28,"label",54),r.cd(29,"Confirm Password"),r.gc(),r.ad(30,k,2,0,"small",26),r.gc(),r.gc(),r.gc(),r.hc(31,"div",55),r.hc(32,"button",56),r.sc("click",(function(){r.Qc(e);const n=r.Oc(6);return r.wc().onSubmitResetPwd(n)})),r.cd(33,"Confirm"),r.gc(),r.gc()}if(2&e){const e=r.Oc(6),n=r.Oc(9),t=r.Oc(16),c=r.Oc(27),o=r.wc();r.Nb(8),r.Ec("ngModel",o.change_user_details.old_password),r.Nb(4),r.Ec("ngIf","Incorrect User or Password"==o.wrong_password),r.Nb(1),r.Ec("ngIf","Password matched"==o.wrong_password),r.Nb(2),r.Ec("ngModel",o.change_user_details.new_password),r.Nb(7),r.Ec("ngIf",e.submitted&&(null==t||null==t.errors?null:t.errors.required)),r.Nb(1),r.Ec("ngIf",e.submitted&&t.errors.pattern),r.Nb(1),r.Ec("ngIf",(null==t?null:t.value)&&(null==t?null:t.value)==(null==n?null:n.value)),r.Nb(2),r.Ec("ngModel",o.change_user_details.confirmPassword),r.Nb(4),r.Ec("ngIf",(null==t?null:t.value)!=(null==c?null:c.value)&&(null==c?null:c.value)),r.Nb(2),r.Ec("disabled",e.valid&&("Incorrect User or Password"==o.wrong_password||(null==t?null:t.value)!=(null==c?null:c.value)||(null==t?null:t.value)==(null==n?null:n.value)))}}const N=function(){return["/faqs"]},S=[{path:"",component:(()=>{class e{constructor(e,n,t,c,o,s){this.router=e,this.http=n,this.toastr=t,this.socketService=c,this.modalService=o,this.cookie=s,this.destroyEvents=new r.q,this.toastButtons=[{id:"1",title:"view jobs 1"},{id:"2",title:"view jobs 2"}],this.new_password="",this.login_resp={},this.login_form_data={},this.show_password=!1,this.confirmPassword="",this.change_user_details={}}ngAfterViewInit(){["sid","user_id","full_name","system_user"].forEach(e=>{document.cookie=e+"=; expire=Thu, 01 Jan 1970 00:00:00 UTC; path=/;"})}ngOnInit(){}onSubmit(e){if(e.valid){const n=new FormData;n.append("usr",e.value.username),n.append("pwd",e.value.password),n.append("cmd","login"),n.append("device","desktop"),this.http.post(s.a.login,{usr:e.value.username,pwd:e.value.password}).subscribe(n=>{this.login_resp=null==n?void 0:n.full_name,this.login_form_data=e.value,this.getCompanyData(),this.getUSerList()},n=>{console.log(n.error.exc_type,"============ ",n.error.exception," ++++ ",n.error._server_message),e.form.setErrors("SecurityException"==n.error.exc_type?{error:n.error.exception.split(":").pop()}:{error:n.error.message})})}else e.form.markAllAsTouched()}resetPAssword(e){e.valid&&(this.login_form_data=e.value,this.http.post(s.a.reset_password,{user:e.value.username,doctype:"User",fieldname:"password"}).subscribe(e=>{var n,t,c;"New login force to reset"==(null===(n=null==e?void 0:e.message)||void 0===n?void 0:n.message)||0==(null===(t=null==e?void 0:e.message)||void 0===t?void 0:t.remaining_days)?(this.userData=null==e?void 0:e.message,this.wrong_password="",this.modalService.open(this.usersModel,{size:"md",centered:!0,backdrop:"static"})):"Old login"==(null===(c=null==e?void 0:e.message)||void 0===c?void 0:c.message)?this.show_password=!0:this.toastr.error("Invalid User")}))}check_old_password(e){e.length>=6&&this.http.post(s.a.check_old_password,{user:this.userData.user,pwd:e}).subscribe(e=>{var n;(null==e?void 0:e.message)&&(this.wrong_password=null===(n=null==e?void 0:e.message)||void 0===n?void 0:n.message)})}getUSerList(){const e={filters:[]};e.filters.push(["full_name","like",`%${this.login_resp}%`]);let n=/\S+@\S+\.\S+/.test(this.login_form_data.username);console.log(n),e.filters.push(n?["email","like",`%${this.login_form_data.username}%`]:["username","like",`%${this.login_form_data.username}%`]),e.filters=JSON.stringify(e.filters),this.http.get(""+s.a.users,{params:e}).subscribe(e=>{var n;(null==e?void 0:e.data)&&this.http.get(`${s.a.users}/${null===(n=null==e?void 0:e.data[0])||void 0===n?void 0:n.name}`).subscribe(e=>{if(null==e?void 0:e.data){let n=e.data.roles.map(e=>e.role);n=n.filter(e=>e.includes("ezy-")),e.data.rolesFilter=n,localStorage.setItem("login",JSON.stringify(null==e?void 0:e.data)),this.router.navigate(["/home/dashboard"]),this.toastr.success("successfully logged in ")}})})}getCompanyData(){this.http.get(s.a.company).subscribe(e=>{let n=e.data[0];n&&this.http.get(s.a.company+"/"+(null==n?void 0:n.name)).subscribe(e=>{localStorage.setItem("company",JSON.stringify(e.data))})})}ngOnDestroy(){this.modalService.dismissAll(),["sid","user_id","full_name","system_user"].forEach(e=>{document.cookie=e+'="sumanth"; expire=2022-08-05T06:43:18.966Z; path=/;'})}onSubmitResetPwd(e){var n;console.log(this.login_form_data),e.form.markAllAsTouched(),e.valid&&this.http.post(""+s.a.initial_password,{email:null===(n=this.userData)||void 0===n?void 0:n.user,last_password_reset_date:a()(new Date).format("YYYY-MM-DD"),new_password:e.value.new_password,old_pwd:e.value.old_password}).subscribe(e=>{var n;console.log(e),(null===(n=null==e?void 0:e.message)||void 0===n?void 0:n.success)?(this.toastr.success("Password Changed"),this.modalService.dismissAll(),this.show_password=!0):this.toastr.error("Failed")})}}return e.\u0275fac=function(n){return new(n||e)(r.bc(o.e),r.bc(l.b),r.bc(d.d),r.bc(g.a),r.bc(u.k),r.bc(h.a))},e.\u0275cmp=r.Vb({type:e,selectors:[["app-login"]],viewQuery:function(e,n){var t;1&e&&r.jd(f,!0),2&e&&r.Nc(t=r.tc())&&(n.usersModel=t.first)},decls:76,vars:7,consts:[[1,"bg-login"],[1,"container"],[1,"row"],[1,"col-md-7","my-auto"],[1,"content"],[1,"text-secondary"],[1,"mb-5"],[1,"c-border"],[1,"list-unstyled"],[1,"ri-check-line"],[1,"ri-close-fill"],[1,"col-md-5"],[1,"card","p-2","mb-4"],[1,"card-body"],[1,"row","mb-4"],[1,"col-12"],[1,"logo","mb-2"],["src","assets/images/EzyinvoiceLogo.png","alt","logo",1,"img-fluid"],[1,"text-muted"],["form","ngForm"],[1,"text-center","mb-4"],[1,"text-danger"],[1,"form-group"],["type","text","appMatInput","","name","username","id","name","ngModel","","required","",1,"form-control"],["name","ngModel"],["for","name",1,"mat-label"],["class","text-danger",4,"ngIf"],["class","form-group",4,"ngIf"],[1,"pt-3"],["class","btn btn-block btn-primary text-uppercase",3,"click",4,"ngIf"],[1,"mt-3","faq"],["target","_blank",1,"text-dark",3,"routerLink"],[1,"ri-wechat-line"],[1,""],[1,"text-white","m-0"],["href","mailto: support@caratred.com"],["content",""],["type","password","appMatInput","","name","password","id","password","ngModel","","maxlength","30","required","",1,"form-control"],["password","ngModel"],["for","password",1,"mat-label"],[1,"btn","btn-block","btn-primary","text-uppercase",3,"click"],[1,"modal-header"],["id","modal-basic-title"],[1,"modal-body"],["appMatInput","","id","old_password","type","password","name","old_password","required","",1,"form-control",3,"ngModel","ngModelChange"],["old_password","ngModel"],["for","old_password",1,"mat-label"],["class","text-success",4,"ngIf"],["appMatInput","","id","newPassword","type","password","name","new_password","pattern","^(?=.*[A-Za-z])(?=.*\\d)(?=.*[@$!%*#?&])[A-Za-z\\d@$!%*#?&]{6,20}$","required","",1,"form-control",3,"ngModel","ngModelChange"],["new_password","ngModel"],["for","newPassword",1,"mat-label"],[1,"text-mute","note-font"],["appMatInput","","id","confirmPassword","type","password","name","confirmPassword","required","",1,"form-control",3,"ngModel","ngModelChange"],["confirmPassword","ngModel"],["for","confirmPassword",1,"mat-label"],[1,"modal-footer","border-0","d-block","text-center","pb-4"],["type","button",1,"btn","btn-primary",3,"disabled","click"],[1,"text-success"]],template:function(e,n){if(1&e&&(r.hc(0,"section",0),r.hc(1,"div",1),r.hc(2,"div",2),r.hc(3,"div",3),r.hc(4,"div",4),r.hc(5,"h2"),r.cd(6,"Automated "),r.cc(7,"br"),r.hc(8,"span",5),r.cd(9," E-Invoice"),r.gc(),r.cd(10," Integration Process"),r.gc(),r.hc(11,"div",6),r.cc(12,"span",7),r.gc(),r.hc(13,"div"),r.hc(14,"ul",8),r.hc(15,"li"),r.cc(16,"i",9),r.cd(17," Instant Invoice Submission"),r.gc(),r.hc(18,"li"),r.cc(19,"i",9),r.cd(20," Imprint IRN & QR Code to submitted Invoice"),r.gc(),r.hc(21,"li"),r.cc(22,"i",9),r.cd(23," Monthly Invoicing Reconciliation"),r.gc(),r.gc(),r.hc(24,"ul",8),r.hc(25,"li"),r.cc(26,"i",10),r.cd(27," No Bulk Invoice Uploads Required"),r.gc(),r.hc(28,"li"),r.cc(29,"i",10),r.cd(30," No PMS Upgrades Required"),r.gc(),r.hc(31,"li"),r.cc(32,"i",9),r.cd(33," Works with any PMS"),r.gc(),r.gc(),r.gc(),r.gc(),r.gc(),r.hc(34,"div",11),r.hc(35,"div",12),r.hc(36,"div",13),r.hc(37,"div",14),r.hc(38,"div",15),r.hc(39,"div",16),r.cc(40,"img",17),r.gc(),r.hc(41,"h2"),r.cd(42,"Welcome to EZY Invoice"),r.gc(),r.hc(43,"p",18),r.hc(44,"b"),r.cd(45,"Sign in using your credentials"),r.gc(),r.gc(),r.gc(),r.gc(),r.hc(46,"form",null,19),r.hc(48,"div",20),r.hc(49,"p",21),r.hc(50,"strong"),r.cd(51),r.gc(),r.gc(),r.gc(),r.hc(52,"div",22),r.cc(53,"input",23,24),r.hc(55,"label",25),r.cd(56,"Username"),r.gc(),r.ad(57,w,2,0,"small",26),r.gc(),r.ad(58,_,6,1,"div",27),r.hc(59,"div",28),r.ad(60,v,2,0,"button",29),r.ad(61,M,2,0,"button",29),r.hc(62,"div",30),r.hc(63,"a",31),r.hc(64,"b"),r.cc(65,"i",32),r.cd(66," FAQs"),r.gc(),r.gc(),r.gc(),r.gc(),r.gc(),r.gc(),r.gc(),r.hc(67,"div"),r.hc(68,"div",33),r.hc(69,"p",34),r.cd(70,"Have a problem? Contact us at "),r.hc(71,"a",35),r.cd(72," support@caratred.com"),r.gc(),r.gc(),r.cc(73,"br"),r.gc(),r.gc(),r.gc(),r.gc(),r.gc(),r.gc(),r.ad(74,I,34,10,"ng-template",null,36,r.bd)),2&e){const e=r.Oc(47),t=r.Oc(54);r.Nb(51),r.dd(e.form.getError("error")),r.Nb(6),r.Ec("ngIf",e.submitted&&(null==t||null==t.errors?null:t.errors.required)),r.Nb(1),r.Ec("ngIf",n.show_password),r.Nb(2),r.Ec("ngIf",!n.show_password),r.Nb(1),r.Ec("ngIf",n.show_password),r.Nb(2),r.Ec("routerLink",r.Hc(6,N))}},directives:[p.u,p.j,p.k,p.b,m.a,p.i,p.l,p.q,c.p,o.h,p.e,p.o],styles:[".login-card[_ngcontent-%COMP%]{min-height:100vh;width:100%;display:flex;display:-ms-flexbox;justify-content:center;align-items:center}.login-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{min-width:500px}.login-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .col-8[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.45rem}@media (max-width:767px){.card[_ngcontent-%COMP%]{min-width:320px!important}}.bg-login[_ngcontent-%COMP%]{background:url(login-bg.576f40086191f9afdbda.png);background-size:contain;background-position:50%;height:100vh;width:100%;display:flex;justify-content:center;align-items:center}.bg-login[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#fff;font-size:28px;line-height:39px;font-weight:600}.bg-login[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   span.c-border[_ngcontent-%COMP%]{width:180px;height:2px;background:#fff;display:block;margin:20px 0}.bg-login[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:17px;color:#fff;padding:5px 0;font-weight:500}.bg-login[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:10px;font-weight:700}.bg-login[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#17125c;font-size:20px;font-weight:500;margin-bottom:5px}.logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:40px}.faq[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px;position:relative;top:3px}.faq[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{color:#17125c}.faq[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:none}.note-font[_ngcontent-%COMP%]{font-size:11px!important}"]}),e})()}];let E=(()=>{class e{}return e.\u0275mod=r.Zb({type:e}),e.\u0275inj=r.Yb({factory:function(n){return new(n||e)},imports:[[o.i.forChild(S)],o.i]}),e})(),q=(()=>{class e{}return e.\u0275mod=r.Zb({type:e}),e.\u0275inj=r.Yb({factory:function(n){return new(n||e)},imports:[[c.c,E,p.d,m.b]]}),e})()}}]);