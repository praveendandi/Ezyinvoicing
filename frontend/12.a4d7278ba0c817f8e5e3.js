(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{mmdM:function(e,t,c){"use strict";c.d(t,"a",(function(){return P}));var n=c("t0ZU"),a=c("C3g4"),i=c("wd/R"),o=c("fXoL"),r=c("tk/3"),s=c("1kSV"),l=c("5eHb"),d=c("tyNb"),g=c("3Pt+"),u=c("HgEw"),h=c("BcJq"),m=c("ofXK"),p=c("ZOsW"),b=c("CzEO");function _(e,t){if(1&e&&(o.hc(0,"small",37),o.cd(1),o.gc()),2&e){o.wc();const e=o.Nc(26);o.Nb(1),o.dd(null==e||null==e.errors?null:e.errors.specialCharacter)}}function v(e,t){1&e&&(o.hc(0,"span"),o.cd(1,"/ PAX"),o.gc())}function f(e,t){if(1&e){const e=o.ic();o.hc(0,"div",10),o.hc(1,"div",11),o.hc(2,"label",38),o.cd(3,"Original Tax Invoice Number"),o.gc(),o.hc(4,"input",39),o.sc("ngModelChange",(function(t){return o.Pc(e),o.wc().creditInvoice.tax_invoice_referrence_number=t})),o.gc(),o.gc(),o.gc()}if(2&e){const e=o.wc();o.Nb(4),o.Dc("ngModel",e.creditInvoice.tax_invoice_referrence_number)}}function y(e,t){if(1&e){const e=o.ic();o.hc(0,"div",10),o.hc(1,"div",11),o.hc(2,"label",40),o.cd(3,"Original Tax Invoice Date"),o.gc(),o.hc(4,"input",41),o.sc("ngModelChange",(function(t){return o.Pc(e),o.wc().creditInvoice.tax_invoice_referrence_date=t})),o.gc(),o.gc(),o.gc()}if(2&e){const e=o.wc();o.Nb(4),o.Dc("max",e.today_date)("ngModel",e.creditInvoice.tax_invoice_referrence_date)}}function x(e,t){if(1&e){const e=o.ic();o.hc(0,"div",42),o.hc(1,"div",43),o.hc(2,"div",44),o.hc(3,"input",45),o.sc("ngModelChange",(function(t){return o.Pc(e),o.wc().creditInvoice.sez=t})),o.gc(),o.hc(4,"label",46),o.cd(5,"SEZ"),o.gc(),o.gc(),o.gc(),o.gc()}if(2&e){const e=o.wc();o.Nb(3),o.Dc("ngModel",e.creditInvoice.sez)}}function M(e,t){if(1&e){const e=o.ic();o.hc(0,"quill-editor",47,48),o.sc("ngModelChange",(function(t){return o.Pc(e),o.wc().creditInvoice.note=t})),o.gc()}if(2&e){const e=o.wc();o.Dc("ngModel",e.creditInvoice.note)}}function D(e,t){if(1&e&&(o.hc(0,"div",8),o.hc(1,"div",10),o.hc(2,"ul",51),o.hc(3,"li"),o.hc(4,"span"),o.cd(5,"Legal Name"),o.gc(),o.hc(6,"strong",52),o.cd(7),o.gc(),o.gc(),o.hc(8,"li"),o.hc(9,"span"),o.cd(10,"GST Number"),o.gc(),o.hc(11,"strong"),o.cd(12),o.gc(),o.gc(),o.hc(13,"li"),o.hc(14,"span"),o.cd(15,"Address 1"),o.gc(),o.hc(16,"strong",52),o.cd(17),o.gc(),o.gc(),o.hc(18,"li"),o.hc(19,"span"),o.cd(20,"Location"),o.gc(),o.hc(21,"strong"),o.cd(22),o.gc(),o.gc(),o.gc(),o.gc(),o.hc(23,"div",10),o.hc(24,"ul",53),o.hc(25,"li"),o.hc(26,"span"),o.cd(27,"Trade Name"),o.gc(),o.hc(28,"strong",52),o.cd(29),o.gc(),o.gc(),o.hc(30,"li"),o.hc(31,"span"),o.cd(32,"State code"),o.gc(),o.hc(33,"strong"),o.cd(34),o.gc(),o.gc(),o.hc(35,"li"),o.hc(36,"span"),o.cd(37,"Address 2"),o.gc(),o.hc(38,"strong",52),o.cd(39),o.gc(),o.gc(),o.hc(40,"li"),o.hc(41,"span"),o.cd(42,"Pincode"),o.gc(),o.hc(43,"strong"),o.cd(44),o.gc(),o.gc(),o.gc(),o.gc(),o.gc()),2&e){const e=o.wc(2);o.Nb(6),o.Ec("ngbTooltip",e.taxPayerDetails.legal_name),o.Nb(1),o.dd(e.taxPayerDetails.legal_name||"NA"),o.Nb(5),o.dd(e.taxPayerDetails.gst_number||"NA"),o.Nb(4),o.Ec("ngbTooltip",e.taxPayerDetails.address_1),o.Nb(1),o.dd(e.taxPayerDetails.address_1||"NA"),o.Nb(5),o.dd(e.taxPayerDetails.location),o.Nb(6),o.Ec("ngbTooltip",e.taxPayerDetails.trade_name),o.Nb(1),o.dd(e.taxPayerDetails.trade_name||"NA"),o.Nb(5),o.dd(e.taxPayerDetails.state_code||"NA"),o.Nb(4),o.Ec("ngbTooltip",e.taxPayerDetails.address_2),o.Nb(1),o.dd(e.taxPayerDetails.address_2||"NA"),o.Nb(5),o.dd(e.taxPayerDetails.pincode||"NA")}}function I(e,t){if(1&e&&(o.hc(0,"div",49),o.ad(1,D,45,12,"div",50),o.gc()),2&e){const e=o.wc();o.Nb(1),o.Dc("ngIf",!e.gstNumberError)}}function N(e,t){1&e&&(o.hc(0,"div",54),o.hc(1,"h6",55),o.hc(2,"strong"),o.cd(3,"Please Enter Valid GST Number"),o.gc(),o.gc(),o.gc())}let P=(()=>{class e{constructor(e,t,c,n,a){this.http=e,this.activeModal=t,this.toastr=c,this.router=n,this.activatedRoute=a,this.taxPayerDetails={},this.creditInvoice={},this.place_of_supply="",this.today_date=i(new Date).format("YYYY-MM-DD"),this.paxEnableCompanyCode="RHV-01"}ngOnInit(){if(this.stateCodes=a.a,this.activatedRoute.queryParams.subscribe(e=>{this.manualType=e.type}),this.userData=JSON.parse(localStorage.getItem("login")),this.companyData=JSON.parse(localStorage.getItem("company")),console.log("editInvoiceInfo ====",this.editInvoiceInfo),this.editInvoiceInfo)this.creditInvoice=this.editInvoiceInfo,this.taxPayerDetails=this.editInvoiceInfo,this.taxDetails=!0,this.gstNumberError=!1;else{let e=this.stateCodes.find(e=>{var t;return e.tin===(null===(t=this.companyData)||void 0===t?void 0:t.state_code)});this.place_of_supply=e.tin,this.creditInvoice.place_of_supply=e.state}}changeDescription(e){const t=e;e&&15==e.length&&this.http.get(`${n.a.getClient}?doctype=${n.b.TaxPayerDetail}&fieldname=name&filters=${e}`).subscribe(c=>{c.message?this.http.post(""+n.a.taxPayersDetails,{data:{code:this.companyData.company_code,gstNumber:t}}).subscribe(t=>{var c;try{t.message.success?(this.taxDetails=!0,this.taxPayerDetails=t.message.data,this.gstNumberError=!1):(this.toastr.error(t.message.message),this.gstNumberError=!0),t.message&&(this.apiMethod=null===(c=t.message)||void 0===c?void 0:c.update,!1===this.apiMethod?this.http.post(""+n.a.taxPayerDefault,this.taxPayerDetails).subscribe(e=>{}):this.http.put(`${n.a.taxPayerDefault}/${this.taxPayerDetails.gst_number}`,this.taxPayerDetails).subscribe(e=>{}))}catch(e){console.log(e)}}):this.gstNumberError=!0})}modelChangeFn(e){this.place_of_supply=e.tin}onSubmit(e){const t=e.value;if(1==/\//g.test(e.form.get("invoice_number").value)&&(e.form.get("invoice_number").setErrors({specialCharacter:'"/" character not allowed'}),e.form.get("invoice_number").markAllAsTouched()),e.valid)if(this.editInvoiceInfo){e.value.sez=e.value.sez?1:0;let t=Object.assign(Object.assign({},this.taxPayerDetails),e.value);console.log(t),this.activeModal.close(t)}else this.http.post(n.a.creditInvoice,{place_of_supply:this.place_of_supply,guest_name:t.guest_name,invoice_number:t.invoice_number,membership:"",invoice_date:t.invoice_date,total_invoice_amount:"Credit"==this.manualType?-t.total_invoice_amount:t.total_invoice_amount,invoice_type:"B2B",amount_before_gst:0,amount_after_gst:0,gst_number:this.taxPayerDetails.gst_number,room_number:t.room_number?t.room_number:t.invoice_number,confirmation_number:t.invoice_number,print_by:this.userData.full_name,invoice_category:"Credit"===this.manualType?"Credit Invoice":"Tax"===this.manualType?"Tax Invoice":"Debit Invoice",company:this.companyData.company_code,legal_name:this.taxPayerDetails.legal_name,trade_name:this.taxPayerDetails.trade_name,address_1:this.taxPayerDetails.address_1,address_2:this.taxPayerDetails.address_2,state_code:this.taxPayerDetails.state_code,location:this.taxPayerDetails.location,pincode:this.taxPayerDetails.pincode,mode:this.companyData.mode,sez:t.sez?1:0,invoice_file:" ",doctype:"Invoices",has_credit_items:"Yes",irn_generated:"Draft",invoice_from:"Web",tax_invoice_referrence_number:t.tax_invoice_referrence_number,tax_invoice_referrence_date:t.tax_invoice_referrence_date,note:e.value.note}).subscribe(e=>{e.data&&(this.router.navigate(["/home/manual-credit-details/"+e.data.invoice_number],{queryParams:{type:this.manualType}}),this.activeModal.close())},e=>{});else e.form.markAllAsTouched()}closeModal(){this.activeModal.close()}}return e.\u0275fac=function(t){return new(t||e)(o.bc(r.b),o.bc(s.d),o.bc(l.d),o.bc(d.e),o.bc(d.a))},e.\u0275cmp=o.Vb({type:e,selectors:[["app-create-invoice-manual"]],decls:64,vars:21,consts:[["addCredit",""],[1,"modal-header","addCredit"],["id","modal-basic-title",1,"mb-0"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body","px-4","pt-2","pb-4"],[3,"ngSubmit"],["form","ngForm"],[1,"row"],[1,"col-md-12","addCredit","mb-2"],[1,"col-md-6"],[1,"form-group"],["placeholder","Enter GST Number *","type","text","appMatInput","","id","gst_number","name","gst_number","minlength","15","maxlength","15","appValidateGST","",1,"form-control","text-uppercase",3,"ngModel","ngModelChange"],["gst_number","ngModel"],["for","invoice_number",1,"mat-label"],["appMatInput","","noWhiteSpace","","id","invoice_number","type","text","name","invoice_number","required","",1,"form-control",3,"ngModel","ngModelChange"],["invoice_number","ngModel"],["class","text-danger",4,"ngIf"],["for","invoice_date",1,"mat-label"],["type","text","onfocus","(this.type='date')","onblur","if(!this.value)this.type='text'","appMatInput","","id","invoice_date","type","text","name","invoice_date","required","",1,"form-control",3,"max","ngModel","ngModelChange"],["for","guest_name",1,"mat-label"],["id","guest_name","appMatInput","","type","text","name","guest_name",1,"form-control",3,"ngModel","ngModelChange"],["for","room_number",1,"mat-label"],[4,"ngIf"],["appNumberInput","","maxlength","9","appMatInput","","id","room_number","type","text","name","room_number",1,"form-control",3,"ngModel","ngModelChange"],["bindLabel","state","placeholder","Place of supply","name","place_of_supply","required","",1,"custom",3,"items","ngModel","ngModelChange"],["place_of_supply","ngModel"],["class","col-md-6",4,"ngIf"],["class","col-md-6 my-auto",4,"ngIf"],["class","ql-container mb-3 mx-3","id","note","name","note",3,"ngModel","ngModelChange",4,"ngIf"],[1,"col-md-12"],["class","bg-gray each-block",4,"ngIf"],["class","bg-gray each-block text-center",4,"ngIf"],[1,"col-md-12","mt-3"],[1,"text-right"],["type","button",1,"btn","btn-outline-dark",3,"click"],["type","submit",1,"btn","btn-primary","ml-3",3,"disabled"],[1,"text-danger"],["for","tax_invoice_referrence_number",1,"mat-label"],["appMatInput","","appDecimaNumber","","id","tax_invoice_referrence_number","type","text","name","tax_invoice_referrence_number",1,"form-control",3,"ngModel","ngModelChange"],["for","tax_invoice_referrence_date",1,"mat-label"],["type","text","onfocus","(this.type='date')","onblur","if(!this.value)this.type='text'","appMatInput","","id","tax_invoice_referrence_date","type","text","name","tax_invoice_referrence_date",1,"form-control",3,"max","ngModel","ngModelChange"],[1,"col-md-6","my-auto"],[1,"form-group","pl-2"],[1,"custom-control","custom-checkbox"],["name","sez","type","checkbox","id","SEZ",1,"custom-control-input",3,"ngModel","ngModelChange"],["for","SEZ",1,"custom-control-label","scale-2"],["id","note","name","note",1,"ql-container","mb-3","mx-3",3,"ngModel","ngModelChange"],["note","ngModel"],[1,"bg-gray","each-block"],["class","row",4,"ngIf"],[1,"list-unstyled"],["placement","top",1,"text-truncate",3,"ngbTooltip"],[1,"list-unstyled","text-right"],[1,"bg-gray","each-block","text-center"],[1,"py-3"]],template:function(e,t){if(1&e){const e=o.ic();o.hc(0,"div",null,0),o.hc(2,"div",1),o.hc(3,"h5",2),o.hc(4,"strong"),o.cd(5),o.gc(),o.gc(),o.hc(6,"button",3),o.sc("click",(function(){return o.Pc(e),o.Nc(11).reset(),t.closeModal()})),o.hc(7,"span",4),o.cd(8,"\xd7"),o.gc(),o.gc(),o.gc(),o.hc(9,"div",5),o.hc(10,"form",6,7),o.sc("ngSubmit",(function(){o.Pc(e);const c=o.Nc(11);return t.onSubmit(c)})),o.hc(12,"div",8),o.hc(13,"div",9),o.hc(14,"h5"),o.hc(15,"strong"),o.cd(16,"Tax Payer Details"),o.gc(),o.gc(),o.gc(),o.hc(17,"div",10),o.hc(18,"div",11),o.hc(19,"input",12,13),o.sc("ngModelChange",(function(e){return t.changeDescription(e)}))("ngModelChange",(function(e){return t.taxPayerDetails.gst_number=e})),o.gc(),o.gc(),o.gc(),o.hc(21,"div",10),o.hc(22,"div",11),o.hc(23,"label",14),o.cd(24,"Invoice Number *"),o.gc(),o.hc(25,"input",15,16),o.sc("ngModelChange",(function(e){return t.creditInvoice.invoice_number=e})),o.gc(),o.ad(27,_,2,1,"small",17),o.cd(28),o.xc(29,"json"),o.gc(),o.gc(),o.hc(30,"div",10),o.hc(31,"div",11),o.hc(32,"label",18),o.cd(33,"Invoice Date *"),o.gc(),o.hc(34,"input",19),o.sc("ngModelChange",(function(e){return t.creditInvoice.invoice_date=e})),o.gc(),o.gc(),o.gc(),o.hc(35,"div",10),o.hc(36,"div",11),o.hc(37,"label",20),o.cd(38,"Guest Name *"),o.gc(),o.hc(39,"input",21),o.sc("ngModelChange",(function(e){return t.creditInvoice.guest_name=e})),o.gc(),o.gc(),o.gc(),o.hc(40,"div",10),o.hc(41,"div",11),o.hc(42,"label",22),o.cd(43,"Room "),o.ad(44,v,2,0,"span",23),o.cd(45," Number"),o.gc(),o.hc(46,"input",24),o.sc("ngModelChange",(function(e){return t.creditInvoice.room_number=e})),o.gc(),o.gc(),o.gc(),o.hc(47,"div",10),o.hc(48,"div",11),o.hc(49,"ng-select",25,26),o.sc("ngModelChange",(function(e){return t.modelChangeFn(e)}))("ngModelChange",(function(e){return t.creditInvoice.place_of_supply=e})),o.gc(),o.gc(),o.gc(),o.ad(51,f,5,1,"div",27),o.ad(52,y,5,2,"div",27),o.ad(53,x,6,1,"div",28),o.ad(54,M,2,1,"quill-editor",29),o.hc(55,"div",30),o.ad(56,I,2,1,"div",31),o.ad(57,N,4,0,"div",32),o.gc(),o.hc(58,"div",33),o.hc(59,"div",34),o.hc(60,"button",35),o.sc("click",(function(){return o.Pc(e),o.Nc(11).reset(),t.closeModal()})),o.cd(61,"Cancel"),o.gc(),o.hc(62,"button",36),o.cd(63,"Save"),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.gc()}if(2&e){const e=o.Nc(26);o.Nb(5),o.ed("Create ",t.manualType," Invoice"),o.Nb(14),o.Dc("ngModel",t.taxPayerDetails.gst_number),o.Nb(6),o.Dc("ngModel",t.creditInvoice.invoice_number),o.Nb(2),o.Dc("ngIf",e.touched&&(null==e||null==e.errors?null:e.errors.specialCharacter)),o.Nb(1),o.ed(" ",o.yc(29,19,null==e?null:e.error)," "),o.Nb(6),o.Dc("max",t.today_date)("ngModel",t.creditInvoice.invoice_date),o.Nb(5),o.Dc("ngModel",t.creditInvoice.guest_name),o.Nb(5),o.Dc("ngIf","Tax"==t.manualType&&(null==t.companyData?null:t.companyData.company_code)==t.paxEnableCompanyCode),o.Nb(2),o.Dc("ngModel",t.creditInvoice.room_number),o.Nb(3),o.Dc("items",t.stateCodes)("ngModel",t.creditInvoice.place_of_supply),o.Nb(2),o.Dc("ngIf","Tax"!==t.manualType),o.Nb(1),o.Dc("ngIf","Tax"!==t.manualType),o.Nb(1),o.Dc("ngIf",1!==(null==t.companyData?null:t.companyData.disable_sez)),o.Nb(1),o.Dc("ngIf",1==(null==t.companyData?null:t.companyData.custom_e_tax_invoice)),o.Nb(2),o.Dc("ngIf",t.taxDetails),o.Nb(1),o.Dc("ngIf",t.gstNumberError),o.Nb(5),o.Dc("disabled",!t.taxDetails)}},directives:[g.u,g.j,g.k,g.b,u.a,g.f,g.e,g.i,g.l,h.a,g.q,m.p,p.a,g.a,b.a,s.B],pipes:[m.j],styles:[".each-block[_ngcontent-%COMP%]   .list-unstyled[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style:none;padding:5px 0;display:block;text-decoration:none}.each-block[_ngcontent-%COMP%]   .list-unstyled[_ngcontent-%COMP%]{text-decoration:none}.each-block[_ngcontent-%COMP%]   .list-unstyled[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;font-size:11px;color:#151515;opacity:.5;font-weight:600}.each-block[_ngcontent-%COMP%]   .list-unstyled[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;font-size:13px}.bg-gray[_ngcontent-%COMP%]{background:#f0f0f0;padding:10px}.max-200[_ngcontent-%COMP%]{max-width:200px}"]}),e})()}}]);