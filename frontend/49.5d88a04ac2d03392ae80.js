(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{smRk:function(e,t,r){"use strict";r.r(t),r.d(t,"ErrLogsModule",(function(){return w}));var c=r("ofXK"),i=r("tyNb"),s=r("fXoL"),a=r("cp0P"),n=r("Kj3r"),o=r("eIep"),l=r("t0ZU"),h=r("d+JV"),g=r("tk/3"),d=r("3Pt+"),f=r("z17N");function u(e,t){if(1&e){const e=s.ic();s.hc(0,"div",31),s.hc(1,"input",32),s.sc("ngModelChange",(function(t){return s.Pc(e),s.wc().filters.search.filterDate=t}))("dateTimeChange",(function(){return s.Pc(e),s.wc().updateRouterParams()})),s.gc(),s.hc(2,"span",33),s.cc(3,"i",34),s.gc(),s.cc(4,"owl-date-time",35,36),s.gc()}if(2&e){const e=s.Nc(5),t=s.wc();s.Nb(1),s.Dc("ngModel",t.filters.search.filterDate)("owlDateTime",e)("selectMode","range")("owlDateTimeTrigger",e),s.Nb(1),s.Dc("owlDateTimeTrigger",e),s.Nb(2),s.Dc("pickerType","calendar")}}function p(e,t){if(1&e&&(s.hc(0,"tr"),s.hc(1,"th"),s.cd(2),s.gc(),s.hc(3,"td"),s.cd(4),s.gc(),s.hc(5,"td"),s.cd(6),s.gc(),s.hc(7,"td"),s.cd(8),s.xc(9,"date"),s.gc(),s.gc()),2&e){const e=t.$implicit,r=t.index;s.Nb(2),s.dd(r+1),s.Nb(2),s.dd(null==e?null:e.method),s.Nb(2),s.dd(null==e?null:e.error),s.Nb(2),s.dd(s.yc(9,4,null==e?null:e.creation))}}function m(e,t){1&e&&(s.hc(0,"div",37),s.hc(1,"h5"),s.cd(2,"No Data Found"),s.gc(),s.gc())}function y(e,t){if(1&e){const e=s.ic();s.hc(0,"div"),s.hc(1,"p",43),s.sc("click",(function(){s.Pc(e);const t=s.wc(2);return t.filters.start=t.ErrLogList.length,t.filters.currentPage=t.filters.currentPage+1,t.updateRouterParams()})),s.cd(2," more "),s.gc(),s.gc()}}function b(e,t){if(1&e){const e=s.ic();s.hc(0,"div",38),s.hc(1,"div",39),s.hc(2,"select",40),s.sc("ngModelChange",(function(t){return s.Pc(e),s.wc().filters.itemsPerPage=t}))("change",(function(){return s.Pc(e),s.wc().checkPagination()})),s.hc(3,"option",41),s.cd(4,"20"),s.gc(),s.hc(5,"option",41),s.cd(6,"50"),s.gc(),s.hc(7,"option",41),s.cd(8,"100"),s.gc(),s.hc(9,"option",41),s.cd(10,"150"),s.gc(),s.hc(11,"option",41),s.cd(12,"500"),s.gc(),s.gc(),s.gc(),s.ad(13,y,3,0,"div",42),s.gc()}if(2&e){const e=s.wc();s.Nb(2),s.Dc("ngModel",e.filters.itemsPerPage),s.Nb(1),s.Dc("value",20),s.Nb(2),s.Dc("value",50),s.Nb(2),s.Dc("value",100),s.Nb(2),s.Dc("value",150),s.Nb(2),s.Dc("value",500),s.Nb(2),s.Dc("ngIf",e.ErrLogList.length<e.filters.totalCount)}}class v{constructor(){this.search={name:"",filterBy:"Today",filterDate:"",filterType:"creation"},this.itemsPerPage=20,this.currentPage=1,this.totalCount=0,this.start=0}}const P=[{path:"",component:(()=>{class e{constructor(e,t,r){this.router=e,this.http=t,this.activatedRoute=r,this.ErrLogList=[],this.p=1,this.filters=new v,this.onSearch=new s.q,this.loginUser={}}ngOnInit(){var e;this.companyDetails=JSON.parse(localStorage.getItem("company")),this.filters.itemsPerPage=null===(e=this.companyDetails)||void 0===e?void 0:e.items_per_page,this.activatedRoute.queryParams.subscribe(e=>{if(e.search){const t=JSON.parse(e.search);this.filters.search.filterBy=t.filterBy,this.filters.search.filterType=t.filterType,t.filterDate&&(this.filters.search.filterDate=[new Date(t.filterDate[0]),new Date(t.filterDate[1])])}}),this.onSearch.pipe(Object(n.a)(500)).subscribe(e=>{this.ErrLogList=[],this.filters.start=0,this.filters.totalCount=0,this.updateRouterParams()}),this.getPaymentData(),this.loginUser=JSON.parse(localStorage.getItem("login")),this.loginUSerRole=this.loginUser.rolesFilter.some(e=>"ezy-IT"==e||"ezy-Finance"==e)}updateRouterParams(){const e=JSON.parse(JSON.stringify(this.filters));e.search=JSON.stringify(e.search),this.router.navigate(["home/error-logs"],{queryParams:e})}getPaymentData(){this.activatedRoute.queryParams.pipe(Object(o.a)(e=>{const t={filters:[]};if(t.filters.push(["method","like","%Ezy-invoicing%"]),this.filters.search.name&&t.filters.push(["method","like",`%${this.filters.search.name}%`]),this.filters.search.filterBy)if("Custom"===this.filters.search.filterBy){if(this.filters.search.filterDate){const e=new h.a("Error Log",this.filters.search.filterBy,this.filters.search.filterDate,this.filters.search.filterType).filter;e&&t.filters.push(e)}}else if("All"!==this.filters.search.filterBy){const e=new h.a("Error Log",this.filters.search.filterBy,null,this.filters.search.filterType).filter;e&&t.filters.push(e)}t.limit_start=this.filters.start,t.limit_page_length=this.filters.itemsPerPage,t.order_by="`tabError Log`.`creation` desc",t.fields=JSON.stringify(["name","owner","creation","modified","modified_by","method","error","seen","docstatus"]),t.filters=JSON.stringify(t.filters);const r=this.http.get(""+l.a.errorLog,{params:{fields:JSON.stringify(["count( `tabError Log`.`name`) AS total_count"]),filters:t.filters}}),c=this.http.get(""+l.a.errorLog,{params:t});return Object(a.a)([r,c])})).subscribe(e=>{1==this.filters.currentPage&&(this.ErrLogList=[]);const[t,r]=e;this.filters.totalCount=t.data[0].total_count,r.data=r.data.map((e,t)=>(e&&(e.index=this.ErrLogList.length+t+1),e)),r.data&&(this.ErrLogList=0!==this.filters.start?this.ErrLogList.concat(r.data):r.data)})}checkPagination(){this.filters.currentPage=1,this.updateRouterParams()}onDateFilterChange(){this.filters.currentPage=1,"Custom"==this.filters.search.filterBy?this.filters.search.filterDate="":this.updateRouterParams()}}return e.\u0275fac=function(t){return new(t||e)(s.bc(i.e),s.bc(g.b),s.bc(i.a))},e.\u0275cmp=s.Vb({type:e,selectors:[["app-err-logs"]],decls:55,vars:7,consts:[[1,"row","mb-3"],[1,"col-md-9","col-lg-9"],[1,"d-flex","mb-3"],[1,"text-white"],[1,"d-flex","mx-2"],[1,"form-group","w-c-50","mx-2"],["id","my-select","name","",1,"custom-select","bg-white",3,"ngModel","ngModelChange"],["value","All"],["value","Today"],["value","Yesterday"],["value","This Week"],["value","Last Week"],["value","This Month"],["value","Last Month"],["value","This Year"],["value","Custom"],["class","form-group calendar w-c-50 position-relative",4,"ngIf"],[1,"col-lg-3","col-md-3"],[1,"position-relative","mt-2","mt-lg-0","mt-md-0"],["type","search","placeholder","Search by method",1,"form-control","pl-5",3,"ngModel","ngModelChange","keyup","search","keyup.enter"],["search",""],[1,"search"],[1,"ri-search-line"],[1,"card","pb-1"],[1,"table-responsive"],[1,"table"],[1,"thead"],["head",""],[4,"ngFor","ngForOf"],["class","text-center py-3",4,"ngIf"],["class","d-flex justify-content-between",4,"ngIf"],[1,"form-group","calendar","w-c-50","position-relative"],["placeholder","Date Time",1,"form-control","h-auto",3,"ngModel","owlDateTime","selectMode","owlDateTimeTrigger","ngModelChange","dateTimeChange"],[1,"example-trigger",3,"owlDateTimeTrigger"],[1,"ri-calendar-2-line"],[3,"pickerType"],["dt1",""],[1,"text-center","py-3"],[1,"d-flex","justify-content-between"],[1,"px-3"],["name","itemsPerPage","id","itemsPerPage",1,"custom-select",3,"ngModel","ngModelChange","change"],[3,"value"],[4,"ngIf"],[1,"text-right","pr-5","more","text-primary",3,"click"]],template:function(e,t){if(1&e){const e=s.ic();s.hc(0,"section"),s.hc(1,"div",0),s.hc(2,"div",1),s.hc(3,"div",2),s.hc(4,"h4",3),s.hc(5,"b"),s.cd(6," Error Logs "),s.hc(7,"small"),s.cd(8),s.gc(),s.gc(),s.gc(),s.hc(9,"div",4),s.hc(10,"div",5),s.hc(11,"select",6),s.sc("ngModelChange",(function(e){return t.filters.search.filterBy=e}))("ngModelChange",(function(){return t.onDateFilterChange()})),s.hc(12,"option",7),s.cd(13,"All"),s.gc(),s.hc(14,"option",8),s.cd(15,"Today"),s.gc(),s.hc(16,"option",9),s.cd(17,"Yesterday"),s.gc(),s.hc(18,"option",10),s.cd(19,"This Week"),s.gc(),s.hc(20,"option",11),s.cd(21,"Last Week"),s.gc(),s.hc(22,"option",12),s.cd(23,"This Month"),s.gc(),s.hc(24,"option",13),s.cd(25,"Last Month"),s.gc(),s.hc(26,"option",14),s.cd(27,"This Year"),s.gc(),s.hc(28,"option",15),s.cd(29,"Custom"),s.gc(),s.gc(),s.gc(),s.ad(30,u,6,6,"div",16),s.gc(),s.gc(),s.gc(),s.hc(31,"div",17),s.hc(32,"div",18),s.hc(33,"input",19,20),s.sc("ngModelChange",(function(e){return t.filters.search.name=e}))("keyup",(function(){s.Pc(e);const r=s.Nc(34);return t.filters.search.name=r.value,t.onSearch.emit(t.filters)}))("search",(function(){return t.onSearch.emit(t.filters)}))("keyup.enter",(function(){return t.updateRouterParams()})),s.gc(),s.hc(35,"span",21),s.cc(36,"i",22),s.gc(),s.gc(),s.gc(),s.gc(),s.hc(37,"div",23),s.hc(38,"div",24),s.hc(39,"table",25),s.hc(40,"thead",26,27),s.hc(42,"tr"),s.hc(43,"th"),s.cd(44,"#"),s.gc(),s.hc(45,"th"),s.cd(46,"Method"),s.gc(),s.hc(47,"th"),s.cd(48,"Error"),s.gc(),s.hc(49,"th"),s.cd(50,"Creation"),s.gc(),s.gc(),s.gc(),s.hc(51,"tbody"),s.ad(52,p,10,6,"tr",28),s.gc(),s.gc(),s.ad(53,m,3,0,"div",29),s.gc(),s.ad(54,b,14,7,"div",30),s.gc(),s.gc()}2&e&&(s.Nb(8),s.ed("(",t.filters.totalCount,")"),s.Nb(3),s.Dc("ngModel",t.filters.search.filterBy),s.Nb(19),s.Dc("ngIf","Custom"==t.filters.search.filterBy),s.Nb(3),s.Dc("ngModel",t.filters.search.name),s.Nb(19),s.Dc("ngForOf",t.ErrLogList),s.Nb(1),s.Dc("ngIf",!t.ErrLogList.length),s.Nb(1),s.Dc("ngIf",t.ErrLogList.length))},directives:[d.r,d.i,d.l,d.m,d.t,c.p,d.b,c.o,f.d,f.f,f.c],pipes:[c.f],styles:[".calendar[_ngcontent-%COMP%]{max-width:200px}.calendar[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:absolute;top:5px;right:10px;cursor:pointer}.w-c-50[_ngcontent-%COMP%]{min-width:100px;margin-left:10px}"]}),e})()}];let D=(()=>{class e{}return e.\u0275mod=s.Zb({type:e}),e.\u0275inj=s.Yb({factory:function(t){return new(t||e)},imports:[[i.i.forChild(P)],i.i]}),e})(),w=(()=>{class e{}return e.\u0275mod=s.Zb({type:e}),e.\u0275inj=s.Yb({factory:function(t){return new(t||e)},imports:[[c.c,D,d.d,f.e,f.g]]}),e})()}}]);