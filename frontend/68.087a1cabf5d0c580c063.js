(window.webpackJsonp=window.webpackJsonp||[]).push([[68],{"lS+i":function(e,c,t){"use strict";t.r(c),t.d(c,"PermissionsModule",(function(){return M}));var n=t("ofXK"),o=t("tyNb"),i=t("t0ZU"),l=t("fXoL"),s=t("tk/3"),r=t("3Pt+"),d=t("HgEw"),g=t("rU4h");function a(e,c){if(1&e&&(l.hc(0,"option",17),l.cd(1),l.gc()),2&e){const e=c.$implicit;l.Ec("value",null==e?null:e.name),l.Nb(1),l.dd(null==e?null:e.name)}}function h(e,c){if(1&e){const e=l.ic();l.hc(0,"tr"),l.hc(1,"td"),l.cd(2),l.gc(),l.hc(3,"td"),l.cd(4),l.gc(),l.hc(5,"td"),l.cd(6),l.gc(),l.hc(7,"td",18),l.hc(8,"div",19),l.hc(9,"input",20),l.sc("ngModelChange",(function(t){return l.Qc(e),c.$implicit.read=t}))("change",(function(){return l.Qc(e),l.wc().switchRole()})),l.gc(),l.cc(10,"label",21),l.gc(),l.gc(),l.hc(11,"td",18),l.hc(12,"div",19),l.hc(13,"input",22),l.sc("ngModelChange",(function(t){return l.Qc(e),c.$implicit.write=t}))("change",(function(){return l.Qc(e),l.wc().switchRole()})),l.gc(),l.cc(14,"label",23),l.gc(),l.gc(),l.hc(15,"td",18),l.hc(16,"div",19),l.hc(17,"input",24),l.sc("ngModelChange",(function(t){return l.Qc(e),c.$implicit.create=t}))("change",(function(){return l.Qc(e),l.wc().switchRole()})),l.gc(),l.cc(18,"label",25),l.gc(),l.gc(),l.hc(19,"td",18),l.hc(20,"div",19),l.hc(21,"input",26),l.sc("ngModelChange",(function(t){return l.Qc(e),c.$implicit.export=t}))("change",(function(){return l.Qc(e),l.wc().switchRole()})),l.gc(),l.cc(22,"label",27),l.gc(),l.gc(),l.hc(23,"td",18),l.hc(24,"div",19),l.hc(25,"input",28),l.sc("ngModelChange",(function(t){return l.Qc(e),c.$implicit.delete_perm=t}))("change",(function(){return l.Qc(e),l.wc().switchRole()})),l.gc(),l.cc(26,"label",29),l.gc(),l.gc(),l.hc(27,"td"),l.cd(28),l.xc(29,"date"),l.gc(),l.gc()}if(2&e){const e=c.$implicit,t=c.index;l.Nb(2),l.dd(t+1),l.Nb(2),l.dd(null==e?null:e.module),l.Nb(2),l.dd(null==e?null:e.select_route),l.Nb(3),l.Ec("ngModel",e.read),l.Nb(4),l.Ec("disabled",!e.read)("ngModel",e.write),l.Nb(4),l.Ec("disabled",!e.read)("ngModel",e.create),l.Nb(4),l.Ec("disabled",!e.read)("ngModel",e.export),l.Nb(4),l.Ec("disabled",!e.read)("ngModel",e.delete_perm),l.Nb(3),l.dd(l.zc(29,13,null==e?null:e.modified,"short"))}}function u(e,c){1&e&&(l.hc(0,"tr"),l.hc(1,"td",30),l.cd(2,"No Data Found"),l.gc(),l.gc())}function m(e,c){1&e&&(l.hc(0,"div",31),l.hc(1,"h5"),l.cd(2,"No Data Found"),l.gc(),l.gc())}const p=[{path:"",component:(()=>{class e{constructor(e){this.http=e,this.permissionsList=[],this.rolesList=[],this.permissionObj={}}ngOnInit(){this.getTotalRolesCount()}getTotalRolesCount(){this.http.get(""+i.a.roles,{params:{fields:JSON.stringify(["count( `tabRole`.`name`) AS total_count"])}}).subscribe(e=>{this.getRoles(e.data[0].total_count)})}getRoles(e){this.http.get(i.a.roles,{params:{fields:JSON.stringify(["*"]),filters:JSON.stringify([["name","like","%ezy-%"],["disabled","!=","1"],["role_name","!=","ezy-Admin"]])}}).subscribe(e=>{this.rolesList=e.data,this.selectedRole=this.rolesList[0].name,this.getPermissionByRoles()})}getPermissionByRoles(){let e=JSON.parse(localStorage.getItem("login"));this.http.get(`${i.a.roles_permission}/${this.selectedRole}`,{params:{fields:JSON.stringify(["*"])}}).subscribe(c=>{var t;(null==c?void 0:c.data)&&(this.permissionsList=null===(t=c.data)||void 0===t?void 0:t.permission_list,"ezy-Admin"!=e.rolesFilter[0].toLowerCase()&&(this.permissionsList=this.permissionsList.filter(e=>{if("User Management"!=(null==e?void 0:e.select_route)&&"User Management-Details"!=(null==e?void 0:e.select_route)&&"Role Management"!=(null==e?void 0:e.select_route)&&"Permissions"!=(null==e?void 0:e.select_route))return e})))})}selectRole(e){this.selectedRole=e.target.value,this.getPermissionByRoles()}switchRole(){this.permissionsList.forEach(e=>{e.read||(e.write=0,e.export=0,e.create=0,e.delete_perm=0)}),this.http.put(`${i.a.roles_permission}/${this.selectedRole}`,{permission_list:this.permissionsList}).subscribe(e=>{e.data&&this.getPermissionByRoles()})}}return e.\u0275fac=function(c){return new(c||e)(l.bc(s.b))},e.\u0275cmp=l.Vb({type:e,selectors:[["app-permissions"]],decls:50,vars:11,consts:[[1,"row","mb-3"],[1,"col-md-9","col-lg-9"],[1,"d-flex"],[1,"font-weight-bold","text-white"],[1,"col-lg-3","col-md-3"],[1,"position-relative","mt-2","mt-lg-0","mt-md-0"],["appMatInput","","name","roles","id","roles","placeholder","Select role","required","",1,"custom-select",3,"ngModel","change","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"card"],[1,"table-responsive"],[1,"table"],[1,"thead"],["type","search","placeholder","Module","id","module",1,"form-control","form-control-sm","bg-grey",3,"ngModel","ngModelChange"],["type","search","placeholder","Route","id","route",1,"form-control","form-control-sm","bg-grey",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","text-center py-3",4,"ngIf"],[3,"value"],[1,""],[1,"form-check","form-switch"],["type","checkbox","id","read","ngModel","","name","read",1,"form-check-input",3,"ngModel","ngModelChange","change"],["for","read",1,"form-check-label"],["type","checkbox","id","write","ngModel","","name","write",1,"form-check-input",3,"disabled","ngModel","ngModelChange","change"],["for","write",1,"form-check-label"],["type","checkbox","id","create","ngModel","","name","create",1,"form-check-input",3,"disabled","ngModel","ngModelChange","change"],["for","create",1,"form-check-label"],["type","checkbox","id","export","ngModel","","name","export",1,"form-check-input",3,"disabled","ngModel","ngModelChange","change"],["for","export",1,"form-check-label"],["type","checkbox","id","delete_perm","ngModel","","name","delete_perm",1,"form-check-input",3,"disabled","ngModel","ngModelChange","change"],["for","delete_perm",1,"form-check-label"],["colspan","8",1,"no-data-row"],[1,"text-center","py-3"]],template:function(e,c){1&e&&(l.hc(0,"section"),l.hc(1,"div",0),l.hc(2,"div",1),l.hc(3,"div",2),l.hc(4,"h4",3),l.cd(5,"Permissions"),l.gc(),l.gc(),l.gc(),l.hc(6,"div",4),l.hc(7,"div",5),l.hc(8,"select",6),l.sc("change",(function(e){return c.selectRole(e)}))("ngModelChange",(function(e){return c.selectedRole=e})),l.ad(9,a,2,2,"option",7),l.gc(),l.gc(),l.gc(),l.gc(),l.hc(10,"div",8),l.hc(11,"div",9),l.hc(12,"table",10),l.hc(13,"thead",11),l.hc(14,"tr"),l.hc(15,"th"),l.cd(16,"S.No"),l.gc(),l.hc(17,"th"),l.cd(18,"Module"),l.gc(),l.hc(19,"th"),l.cd(20,"Route"),l.gc(),l.hc(21,"th"),l.cd(22,"Read"),l.gc(),l.hc(23,"th"),l.cd(24,"Write"),l.gc(),l.hc(25,"th"),l.cd(26,"Create"),l.gc(),l.hc(27,"th"),l.cd(28,"Export"),l.gc(),l.hc(29,"th"),l.cd(30,"Delete"),l.gc(),l.hc(31,"th"),l.cd(32,"Modified On"),l.gc(),l.gc(),l.gc(),l.hc(33,"tbody"),l.hc(34,"tr"),l.cc(35,"td"),l.hc(36,"td"),l.hc(37,"input",12),l.sc("ngModelChange",(function(e){return c.permissionObj.module=e}))("ngModelChange",(function(){return c.permissionObj.route=null})),l.gc(),l.gc(),l.hc(38,"td"),l.hc(39,"input",13),l.sc("ngModelChange",(function(e){return c.permissionObj.route=e}))("ngModelChange",(function(){return c.permissionObj.module=null})),l.gc(),l.gc(),l.cc(40,"td"),l.cc(41,"td"),l.cc(42,"td"),l.cc(43,"td"),l.cc(44,"td"),l.cc(45,"td"),l.gc(),l.ad(46,h,30,16,"tr",14),l.xc(47,"searchPermission"),l.ad(48,u,3,0,"tr",15),l.gc(),l.gc(),l.ad(49,m,3,0,"div",16),l.gc(),l.gc(),l.gc()),2&e&&(l.Nb(8),l.Ec("ngModel",c.selectedRole),l.Nb(1),l.Ec("ngForOf",c.rolesList),l.Nb(28),l.Ec("ngModel",c.permissionObj.module),l.Nb(2),l.Ec("ngModel",c.permissionObj.route),l.Nb(7),l.Ec("ngForOf",l.Ac(47,7,c.permissionsList,c.permissionObj.module,c.permissionObj.route)),l.Nb(2),l.Ec("ngIf",0==(null==c.permissionsList?null:c.permissionsList.length)),l.Nb(1),l.Ec("ngIf",!c.permissionsList.length))},directives:[r.r,d.a,r.q,r.i,r.l,n.o,r.b,n.p,r.m,r.t,r.a],pipes:[g.a,n.f],styles:[".ri-check-line[_ngcontent-%COMP%]{color:green;font-size:18px;font-weight:bolder}"]}),e})()}];let f=(()=>{class e{}return e.\u0275mod=l.Zb({type:e}),e.\u0275inj=l.Yb({factory:function(c){return new(c||e)},imports:[[o.i.forChild(p)],o.i]}),e})();var b=t("oOf3");let M=(()=>{class e{}return e.\u0275mod=l.Zb({type:e}),e.\u0275inj=l.Yb({factory:function(c){return new(c||e)},imports:[[n.c,f,r.d,b.a,d.b,g.b]]}),e})()}}]);